<div id="gridMg"></div>

<script type="text/x-kendo-template" id="popup_editorMg">
    <div>
        <div class="k-edit-label">
            <label for="Value">Gruppe Name:</label>
        </div>
        <div class="k-edit-field">
            <input type="text"
                   name="Value"
                   data-type="string"
                   data-bind="value:Value"
                   class="k-textbox" style="width: 250px" />
        </div>
    </div>
</script>

<script type="text/javascript">
    $(document).ready(function() {
        var dsMg = new kendo.data.DataSource({
            transport: {
                read: {
                    url: "/mandantengruppen/getGruppen",
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8"
                },
                update: {
                    url: "/mandantengruppen/setGruppe",
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8"
                },
                create: {
                    url: "/mandantengruppen/setGruppe",
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8"
                },
                destroy: {
                    url: "/mandantengruppen/delGruppe",
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8"
                },
                parameterMap: function(data, operation) {
                    if (operation === "read") {
                        return JSON.stringify(data);
                    }
                    if (operation !== "read") {
                        return kendo.stringify({ model: data });
                    }
                }
            },
            schema: {
                model: {
                    id: "Id",
                    fields: {
                        Id: { editable: false },
                        Value: { type: "string", editable: true, nullable: true }
                    }
                }
            },
            autoSync: false,
            error: function(e) {
                alert(e.status + " " + e.statusText);
            }
        });

        $("#gridMg").kendoGrid({
            dataSource: dsMg,
            scrollable: false,
            toolbar: ["create"],
            editable: {
                mode: "popup",
                update: true,
                destroy: true,
                confirmation: "Diese Gruppe wirklich löschen?\n\nMitglieder, welche der Gruppe zugeteilt sind, haben nach der Löschung keine Gruppenzuordnung mehr.",
                template: $("#popup_editorMg").html()
            },
            columns: [
                {
                    command: [
                        { name: "edit", text: "" },
                        { name: "destroy", text: "" }
                    ],
                    titel: "&nbsp;",
                    width: 80
                }, {
                    field: "Value",
                    title: "Gruppe Name"
                }
            ],
            edit: function(e) {
                e.container.kendoWindow("title", "Gruppen");
            }
        });
    });
</script>

<style scoped>
    .k-edit-form-container { width: 600px; }
    .k-edit-form-container input { width: 300px; }
</style>